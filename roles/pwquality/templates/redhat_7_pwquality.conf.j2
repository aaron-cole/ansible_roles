{{ ansible_managed | comment }}
#
# Configuration for systemwide password quality limits
# Defaults:
#
# Number of characters in the new password that must not be present in the
# old password.
{% if pwquality_difok | length > 0 -%}
difok = {{ pwquality_difok }}
{% else %}
# difok = 5
{% endif %}
#
# Minimum acceptable size for the new password (plus one if
# credits are not disabled which is the default). (See pam_cracklib manual.)
# Cannot be set to lower value than 6.
{% if pwquality_minlen | length > 0 -%}
minlen = {{ pwquality_minlen }}
{% else %}
# minlen = 9
{% endif %}
#
# The maximum credit for having digits in the new password. If less than 0
# it is the minimum number of digits in the new password.
{% if pwquality_dcredit | length > 0 -%}
dcredit = {{ pwquality_dcredit }}
{% else %}
# dcredit = 1
{% endif %}
#
# The maximum credit for having uppercase characters in the new password.
# If less than 0 it is the minimum number of uppercase characters in the new
# password.
{% if pwquality_ucredit | length > 0 -%}
ucredit = {{ pwquality_ucredit }}
{% else %}
# ucredit = 1
{% endif %}
#
# The maximum credit for having lowercase characters in the new password.
# If less than 0 it is the minimum number of lowercase characters in the new
# password.
{% if pwquality_lcredit | length > 0 -%}
lcredit = {{ pwquality_lcredit }}
{% else %}
# lcredit = 1
{% endif %}
#
# The maximum credit for having other characters in the new password.
# If less than 0 it is the minimum number of other characters in the new
# password.
{% if pwquality_ocredit | length > 0 -%}
ocredit = {{ pwquality_ocredit }}
{% else %}
# ocredit = 1
{% endif %}
#
# The minimum number of required classes of characters for the new
# password (digits, uppercase, lowercase, others).
{% if pwquality_minclass | length > 0 -%}
minclass = {{ pwquality_minclass }}
{% else %}
# minclass = 0
{% endif %}
#
# The maximum number of allowed consecutive same characters in the new password.
# The check is disabled if the value is 0.
{% if pwquality_maxrepeat | length > 0 -%}
maxrepeat = {{ pwquality_maxrepeat }}
{% else %}
# maxrepeat = 0
{% endif %}
#
# The maximum number of allowed consecutive characters of the same class in the
# new password.
# The check is disabled if the value is 0.
{% if pwquality_maxclassrepeat | length > 0 -%}
maxclassrepeat = {{ pwquality_maxclassrepeat }}
{% else %}
# maxclassrepeat = 0
{% endif %}
#
# Whether to check for the words from the passwd entry GECOS string of the user.
# The check is enabled if the value is not 0.
{% if pwquality_gecoscheck | length > 0 -%}
gecoscheck = {{ pwquality_gecoscheck }}
{% else %}
# gecoscheck = 0
{% endif %}
#
# Path to the cracklib dictionaries. Default is to use the cracklib default.
{% if pwquality_dictpath | length > 0 -%}
dictpath = {{ pwquality_dictpath }}
{% else %}
# dictpath =
{% endif %}
